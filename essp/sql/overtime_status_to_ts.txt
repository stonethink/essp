create or replace trigger overtime_status_to_ts
  after update on tc_overtime  
  for each row
--此触l器用于⒓影BYD到工r系y
declare
  
begin
if UPDATING then
  --B更新rYDB，⒐r系y中所有加班下的子B更新
  for x in (select d.rid from tc_overtime_detail d where d.overtime_id=:OLD.rid) loop
      --如果更新后的BAborted或Disagreedtrg置0
      if :NEW.status = 'Aborted' then
          update ATT_OVERTIME@DATABASELINK_TO_81 set status=:NEW.status,hours=0,actual_hours=0,rut=sysdate where overtime_detail_id=x.rid;
      elsif :NEW.status = 'Disagreed' then
          update ATT_OVERTIME@DATABASELINK_TO_81 set status=:NEW.status,hours=0,actual_hours=0,rut=sysdate where overtime_detail_id=x.rid;
      else
          update ATT_OVERTIME@DATABASELINK_TO_81 set status=:NEW.status, rut=sysdate where overtime_detail_id=x.rid;
      end if;
  end loop;
end if;
end overtime_status_to_ts;
